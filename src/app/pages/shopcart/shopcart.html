<app-header></app-header>

<ion-content class="ion-padding">
  <div class="cart-container">
    <!-- Título -->
    <div class="page-header">
      <ion-icon name="cart-outline"></ion-icon>
      <h1>Tu Carrito de Compras</h1>
    </div>

    <!-- Carrito vacío -->
    <div *ngIf="cartItems.length === 0" class="empty-cart">
      <ion-icon name="cart-outline"></ion-icon>
      <h2>Tu carrito está vacío</h2>
      <p>Agrega productos para comenzar tu compra</p>
      <ion-button routerLink="/home" expand="block">
        Ir a Comprar
      </ion-button>
    </div>

    <!-- Lista de productos en el carrito -->
    <div *ngIf="cartItems.length > 0" class="cart-content">
      <!-- Items del carrito -->
      <div class="cart-items">
        <ion-card *ngFor="let item of cartItems; let i = index" class="cart-item">
          <ion-card-content>
            <div class="item-content">
              <!-- Imagen del producto -->
              <div class="item-image">
                <img [src]="item.image" [alt]="item.name">
              </div>

              <!-- Info del producto -->
              <div class="item-info">
                <h3>{{ item.name }}</h3>
                <p class="item-size">Talla: {{ item.size }}</p>
                <p class="item-price">{{ item.price | currency:'CLP':'symbol-narrow' }}</p>
              </div>

              <!-- Controles de cantidad -->
              <div class="item-controls">
                <div class="quantity-controls">
                  <ion-button fill="clear" size="small" (click)="decreaseQuantity(i)">
                    <ion-icon name="remove-circle-outline"></ion-icon>
                  </ion-button>
                  <span class="quantity">{{ item.quantity }}</span>
                  <ion-button fill="clear" size="small" (click)="increaseQuantity(i)">
                    <ion-icon name="add-circle-outline"></ion-icon>
                  </ion-button>
                </div>

                <!-- Subtotal -->
                <p class="item-subtotal">
                  {{ item.price * item.quantity | currency:'CLP':'symbol-narrow' }}
                </p>

                <!-- Botón eliminar -->
                <ion-button fill="clear" color="danger" size="small" (click)="removeItem(i)">
                  <ion-icon name="trash-outline"></ion-icon>
                </ion-button>
              </div>
            </div>
          </ion-card-content>
        </ion-card>
      </div>

      <!-- Resumen del carrito -->
      <div class="cart-summary">
        <ion-card>
          <ion-card-header>
            <h2>Resumen del Pedido</h2>
          </ion-card-header>
          <ion-card-content>
            <div class="summary-row">
              <span>Subtotal ({{ getTotalItems() }} items):</span>
              <span>{{ getSubtotal() | currency:'CLP':'symbol-narrow' }}</span>
            </div>
            <div class="summary-row">
              <span>Envío:</span>
              <span>{{ shippingCost | currency:'CLP':'symbol-narrow' }}</span>
            </div>
            <div class="summary-row total">
              <span>Total:</span>
              <span>{{ getTotal() | currency:'CLP':'symbol-narrow' }}</span>
            </div>

            <ion-button expand="block" (click)="checkout()">
              <ion-icon slot="start" name="card-outline"></ion-icon>
              Finalizar Compra
            </ion-button>

            <ion-button expand="block" fill="outline" (click)="continueShopping()">
              Seguir Comprando
            </ion-button>
          </ion-card-content>
        </ion-card>
      </div>
    </div>
  </div>
</ion-content>

<app-footer></app-footer>
